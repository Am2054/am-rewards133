<!DOCTYPE html>    
<html lang="ar" dir="rtl">      
<head>      
  <meta charset="utf-8" />      
  <title>AM Rewards | Ø§Ù„Ù€Ù…Ù€Ø¬Ù€Ø±Ø©</title>      
  <meta name="viewport" content="width=device-width,initial-scale=1" />      
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&family=Montserrat:wght@900&display=swap" rel="stylesheet">      
  <style>      
    :root {      
      --neon-cyan: #00f2ff;
      --neon-purple: #7000ff;
      --bg-deep: #020617;
      --glass-bg: rgba(15, 23, 42, 0.6);
      --glass-border: rgba(255, 255, 255, 0.1);
      --gold: #FFD369;
      --text-main: #f1f5f9;
    }      

    /* ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡: Ø§Ø³ØªØ¨Ø¯Ø§Ù„ all Ø¨Ø®ØµØ§Ø¦Øµ Ù…Ø­Ø¯Ø¯Ø© */
    * { 
      box-sizing: border-box; 
      transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275), 
                  box-shadow 0.4s ease, 
                  opacity 0.4s ease, 
                  background-color 0.4s ease; 
    }      
    
    body { 
      margin: 0; padding: 0; font-family: "Cairo", sans-serif; 
      background: var(--bg-deep); color: var(--text-main);
      min-height: 100vh; overflow-x: hidden;
      background-image: 
        radial-gradient(circle at 10% 20%, rgba(112, 0, 255, 0.1) 0%, transparent 40%),
        radial-gradient(circle at 90% 80%, rgba(0, 242, 255, 0.1) 0%, transparent 40%);
    }

    .nebula {
      position: fixed; inset: 0; z-index: -1;
      background: radial-gradient(circle at 50% 50%, #0f172a 0%, #020617 100%);
    }
    .nebula::after {
      content: ""; position: absolute; width: 200%; height: 200%;
      background-image: url('https://www.transparenttextures.com/patterns/stardust.png');
      opacity: 0.15; /* ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ© */
      animation: stars 100s linear infinite;
    }
    @keyframes stars { from { transform: translateY(0); } to { transform: translateY(-50%); } }

    .container { max-width: 480px; margin: 0 auto; padding: 25px 15px; }

    header {
      display: flex; align-items: center; justify-content: space-between;
      padding: 20px; border-radius: 24px;
      background: var(--glass-bg); backdrop-filter: blur(15px);
      border: 1px solid var(--glass-border); margin-bottom: 25px;
    }
    .logo-glow {
      width: 50px; height: 50px; border-radius: 15px;
      background: linear-gradient(135deg, var(--neon-cyan), var(--neon-purple));
      display: flex; align-items: center; justify-content: center;
      box-shadow: 0 0 20px rgba(0, 242, 255, 0.5);
      font-family: 'Montserrat'; font-size: 20px; color: #fff;
    }

    .profile-card {
      position: relative; padding: 30px 20px; border-radius: 30px;
      background: linear-gradient(135deg, rgba(255,255,255,0.05), rgba(255,255,255,0.01));
      border: 1px solid var(--glass-border); backdrop-filter: blur(20px);
      text-align: center; overflow: hidden; margin-bottom: 25px;
    }
    .profile-card::before {
      content: ""; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
      background: conic-gradient(transparent, var(--neon-cyan), transparent 30%);
      animation: rotateBorder 6s linear infinite; z-index: -1;
    }
    @keyframes rotateBorder { to { transform: rotate(360deg); } }
    .inner-card { background: var(--bg-deep); border-radius: 25px; padding: 20px; }
    
    .avatar-main {
      width: 90px; height: 90px; border-radius: 50%; border: 4px solid var(--neon-cyan);
      margin: -60px auto 15px; background: #1e293b; display: flex;
      align-items: center; justify-content: center; font-size: 40px;
      box-shadow: 0 0 30px rgba(0, 242, 255, 0.3);
    }

    .points-section { margin: 20px 0; display: flex; gap: 15px; }
    .point-box {
      flex: 1; padding: 20px; border-radius: 24px;
      background: rgba(255,255,255,0.03); border: 1px solid var(--glass-border);
      text-align: center;
    }
    .point-box.gold { border-color: var(--gold); box-shadow: 0 0 15px rgba(255, 211, 105, 0.1); }
    .val { font-family: 'Montserrat'; font-size: 32px; display: block; margin: 5px 0; color: var(--neon-cyan); }
    .val.gold-text { color: var(--gold); }

    .goal-card {
      padding: 20px; border-radius: 24px; background: var(--glass-bg);
      border: 1px solid var(--glass-border); margin-bottom: 25px;
    }
    .progress-container {
      height: 12px; background: #1e293b; border-radius: 10px; margin: 15px 0;
      position: relative; overflow: hidden;
    }
    .progress-fill {
      position: absolute; height: 100%; width: 0%;
      background: linear-gradient(90deg, var(--neon-purple), var(--neon-cyan));
      box-shadow: 0 0 15px var(--neon-cyan);
      transition: width 1.5s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© Glow */
    .progress-fill.goal-reached {
      animation: pulseGlow 1.5s infinite alternate;
      box-shadow: 0 0 20px var(--neon-cyan), 0 0 40px var(--neon-purple);
    }
    @keyframes pulseGlow {
      from { filter: brightness(1) drop-shadow(0 0 5px var(--neon-cyan)); }
      to { filter: brightness(1.5) drop-shadow(0 0 20px var(--neon-cyan)); }
    }

    .grid-actions { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
    .action-item {
      padding: 20px; border-radius: 22px; background: var(--glass-bg);
      border: 1px solid var(--glass-border); text-decoration: none; color: #fff;
      display: flex; flex-direction: column; align-items: center; gap: 10px;
      font-weight: 700; position: relative; overflow: hidden;
    }
    .action-item:hover { transform: translateY(-10px); background: rgba(255,255,255,0.1); border-color: var(--neon-cyan); }
    .action-item.full { grid-column: span 2; flex-direction: row; justify-content: space-between; border-color: var(--neon-purple); }

    .btn-logout {
      background: rgba(255, 95, 95, 0.1); color: #ff5f5f; border: 1px solid #ff5f5f;
      padding: 8px 18px; border-radius: 12px; cursor: pointer; font-weight: 800;
      transition: all 0.3s ease;
    }
    .btn-logout:hover { background: #ff5f5f; color: #fff; box-shadow: 0 0 20px #ff5f5f; }
    
    footer { text-align: center; padding: 30px; opacity: 0.5; font-size: 11px; letter-spacing: 1px; }
  </style>      
</head>      
<body>      
  <div class="nebula"></div>      
  
  <div class="container">      
    <header>      
      <div style="display:flex; gap:12px; align-items:center;">
        <div class="logo-glow">AM</div>
        <div style="font-weight:900; font-size:16px;">AM REWARDS</div>
      </div>
      <button id="logoutBtn" class="btn-logout">Ø®Ø±ÙˆØ¬</button>
    </header>    

    <div class="profile-card">
      <div class="inner-card">
        <div class="avatar-main" id="avatar">A</div>
        <h2 id="userName" style="margin:10px 0 5px; font-weight:900;">...</h2>
        <div id="userRefCode" style="font-size:13px; color:var(--neon-cyan); background:rgba(0,242,255,0.08); padding:5px 15px; border-radius:50px; display:inline-block;">ÙƒÙˆØ¯: ---</div>
      </div>
    </div>

    <div class="points-section">
      <div class="point-box">
        <span style="font-size:11px; color:#94a3b8; font-weight:700;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‚Ø§Ø·</span>
        <span class="val" id="userPoints">0</span>
        <span id="pointsEgp" style="font-size:13px; color:var(--neon-purple); font-weight:700;">0.00 Ø¬</span>
      </div>
      <div class="point-box gold">
        <span style="font-size:11px; color:var(--gold); font-weight:700;">Ø±ØµÙŠØ¯ Ø§Ù„Ø³Ø­Ø¨</span>
        <span class="val gold-text" id="userBalanceEgp">0.00</span>
        <span style="font-size:10px; opacity:0.6;">Ø¬Ù†ÙŠÙ‡ Ù…ØµØ±ÙŠ</span>
      </div>
    </div>

    <div class="goal-card">
      <div style="display:flex; justify-content:space-between; align-items:center;">
        <span style="font-weight:700; font-size:14px;">Ù‡Ø¯Ù Ø§Ù„ÙŠÙˆÙ… (1000 Ù†Ù‚Ø·Ø©)</span>
        <span id="progressPercent" style="color:var(--neon-cyan); font-family:'Montserrat'; font-weight:900;">0%</span>
      </div>
      <div class="progress-container">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div style="text-align:left; font-size:12px; color:#94a3b8; font-family:'Montserrat';" id="progressLbl">0 / 1000</div>
    </div>

    <div class="grid-actions">
      <a href="tasks.html" class="action-item">
        <span style="font-size:24px;">ğŸ“</span>
        <span>Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</span>
      </a>
      <a href="referrals.html" class="action-item">
        <span style="font-size:24px;">ğŸ‘¥</span>
        <span>Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡</span>
      </a>
      <a href="withdraw.html" class="action-item full">
        <div style="display:flex; align-items:center; gap:10px;">
          <span style="font-size:24px;">ğŸ’¸</span>
          <span>Ø³Ø­Ø¨ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ ÙƒØ§Ø´</span>
        </div>
        <span style="background:var(--neon-cyan); color:#020617; padding:5px 12px; border-radius:12px; font-size:12px; font-weight:900;">Ø³Ø­Ø¨</span>
      </a>
    </div>

    <div style="display:grid; grid-template-columns: repeat(3, 1fr); gap:10px; margin-top:20px;">
        <div style="background:rgba(255,255,255,0.02); padding:12px; border-radius:18px; text-align:center; border:1px solid var(--glass-border);">
            <div id="pointsToday" style="font-weight:900; color:var(--neon-cyan); font-family:'Montserrat';">0</div>
            <div style="font-size:10px; opacity:0.5;">Ù†Ù‚Ø§Ø· Ø§Ù„ÙŠÙˆÙ…</div>
        </div>
        <div style="background:rgba(255,255,255,0.02); padding:12px; border-radius:18px; text-align:center; border:1px solid var(--glass-border);">
            <div id="totalWithdrawn" style="font-weight:900; color:var(--gold); font-family:'Montserrat';">0</div>
            <div style="font-size:10px; opacity:0.5;">Ø§Ù„Ù…Ø³Ø­ÙˆØ¨Ø§Øª</div>
        </div>
        <div style="background:rgba(255,255,255,0.02); padding:12px; border-radius:18px; text-align:center; border:1px solid var(--glass-border);">
            <div id="referralPoints" style="font-weight:900; color:var(--neon-purple); font-family:'Montserrat';">0</div>
            <div style="font-size:10px; opacity:0.5;">Ø¥Ø­Ø§Ù„Ø§Øª</div>
        </div>
    </div>

    <footer>Â© 2025 AM REWARDS | ØªØ¬Ø±Ø¨Ø© Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ© Ù…Ø·ÙˆØ±Ø©</footer>    
  </div>      

  <script type="module">      
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";      
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";      
    import { getFirestore, doc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";      

    const firebaseConfig = { apiKey: "AIzaSyBfOJPkWbmcJ6s29bDNysr-H0Kx-Js3Gy0", authDomain: "am--rewards.firebaseapp.com", projectId: "am--rewards" };      
    const app = initializeApp(firebaseConfig);      
    const auth = getAuth(app);      
    const db = getFirestore(app);      
    const POINT_VALUE = 0.07;      

    function animateValue(id, start, end, duration) {
        const obj = document.getElementById(id);
        if (!obj) return;
        let startTimestamp = null;
        const step = (timestamp) => {
            if (!startTimestamp) startTimestamp = timestamp;
            const progress = Math.min((timestamp - startTimestamp) / duration, 1);
            obj.innerHTML = (Math.floor(progress * (end - start) + start)).toLocaleString();
            if (progress < 1) window.requestAnimationFrame(step);
        };
        window.requestAnimationFrame(step);
    }

    let lastPoints = 0;

    onAuthStateChanged(auth, (user) => {      
      if (!user) return location.href = 'index.html';      
      
      onSnapshot(doc(db, 'users', user.uid), (snap) => {    
        if (!snap.exists()) return;
        const d = snap.data();
        
        document.getElementById('userName').textContent = d.name || 'Ù…Ø³ØªÙƒØ´Ù';
        document.getElementById('userRefCode').textContent = `ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø­Ø§Ù„Ø©: ${d.referralCode || '---'}`;
        document.getElementById('avatar').textContent = (d.name || 'A')[0].toUpperCase();

        const pts = Number(d.points || 0);
        animateValue("userPoints", lastPoints, pts, 1200);
        lastPoints = pts;

        const egp = (pts * POINT_VALUE).toFixed(2);
        document.getElementById('pointsEgp').textContent = egp + ' Ø¬.Ù…';
        document.getElementById('userBalanceEgp').textContent = egp;

        const ptsToday = d.pointsToday || 0;
        document.getElementById('pointsToday').textContent = ptsToday;
        document.getElementById('totalWithdrawn').textContent = (d.totalWithdrawn || 0) + ' Ø¬';
        document.getElementById('referralPoints').textContent = d.referralPoints || 0;

        // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„Ù†ÙŠÙˆÙ† Ù…Ø¹ ØªØ£Ø«ÙŠØ± Ø§Ù„Ù€ Glow
        const pct = Math.min(Math.round((ptsToday / 1000) * 100), 100);
        const fill = document.getElementById('progressFill');
        const percentText = document.getElementById('progressPercent');

        fill.style.width = pct + '%';
        
        if (pct >= 100) {
            fill.classList.add('goal-reached');
            percentText.style.color = 'var(--gold)';
            percentText.innerHTML = 'ğŸ¯ Ø§ÙƒØªÙ…Ù„!';
        } else {
            fill.classList.remove('goal-reached');
            percentText.style.color = 'var(--neon-cyan)';
            percentText.innerHTML = pct + '%';
        }

        document.getElementById('progressLbl').textContent = `${ptsToday} / 1000`;
      });    
    });

    document.getElementById('logoutBtn').onclick = () => signOut(auth).then(() => location.href = 'index.html');
  </script>    
</body>
</html>

