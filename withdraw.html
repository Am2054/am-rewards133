<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ø·Ù„Ø¨ Ø³Ø­Ø¨ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ | Am Rewards</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Cairo', sans-serif;
      background: #0f172a;
      color: #f1f5f9;
      margin: 0; padding: 0;
      min-height: 100vh;
      position: relative;
      overflow: hidden;
    }
    body::before {
      content: "";
      position: fixed;
      top:0; left:0; width:100vw; height:100vh; z-index:0;
      background: #0f172a linear-gradient(135deg, #0f172a 0%, #38bdf8 100%);
      opacity: 0.22;
      filter: blur(5px);
      animation: bgmove 20s infinite alternate;
    }
    @keyframes bgmove {
      0% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }
    .container {
      max-width: 480px;
      margin: 30px auto;
      background: rgba(15, 23, 42, 0.96);
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 0 30px rgba(56,189,248,0.35), 0 0 80px 0 rgba(56,189,248,0.1);
      position: relative;
      z-index: 2;
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
      color: #38bdf8;
      font-size: 24px;
      letter-spacing: 1px;
    }
    label { display:block; margin:10px 0 5px; font-weight:600; }
    input {
      width: 100%;
      padding: 12px;
      margin-bottom: 12px;
      border: 1px solid #334155;
      border-radius: 8px;
      background: #1e293b;
      color: #f1f5f9;
      font-size: 15px;
    }
    input::placeholder { color:#94a3b8; }
    .info {
      background: #1e293b;
      padding: 10px;
      border-radius: 8px;
      margin-bottom: 12px;
      text-align: center;
      font-size: 15px;
      box-shadow: 0 0 8px #0ea5e9a1;
    }
    button {
      width: 100%;
      background: linear-gradient(90deg, #38bdf8 0%, #0ea5e9 100%);
      color: #0f172a;
      font-weight: 700;
      padding: 12px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: 0.3s;
      font-size: 17px;
      box-shadow: 0 2px 10px #38bdf863;
    }
    button:hover:not(:disabled) { background: #0ea5e9; color: #fff; }
    button:disabled { opacity: 0.6; cursor: not-allowed; }
    .msg { text-align:center; margin-top:10px; font-size:15px; }
    .error { color:#f87171; }
    .success { color:#22c55e; }
    .history {
      margin-top: 28px;
      position: relative;
      z-index: 1;
    }
    .history h2 {
      font-size: 18px;
      margin-bottom: 10px;
      color: #38bdf8;
      text-align: center;
      letter-spacing: 1px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background: #1e293b;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 0 10px #38bdf838;
    }
    th, td {
      padding: 8px;
      text-align: center;
      border-bottom: 1px solid #334155;
      font-size: 14px;
    }
    th {
      background: #0ea5e9;
      color: #0f172a;
    }
    .status {
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 5px;
    }
    .status-pending { color: orange; }
    .status-completed { color: #22c55e; }
    .status-rejected { color: #f87171; }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ’¸ Ø·Ù„Ø¨ Ø³Ø­Ø¨ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­</h1>
    <div class="info">Ø±ØµÙŠØ¯Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ: <span id="pointsVal">0</span> Ù†Ù‚Ø·Ø© â‰ˆ <span id="egpVal">0.00</span> Ø¬Ù…</div>
    <label>Ø±Ù‚Ù… Ù…Ø­ÙØ¸Ø© ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´</label>
    <input type="text" id="walletVod" placeholder="Ø§Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø©">
    <label>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø±Ø§Ø¯ Ø³Ø­Ø¨Ù‡ (20 - 200 Ø¬Ù†ÙŠÙ‡)</label>
    <input type="number" id="amountInp" placeholder="Ø§Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº" min="20">

    <div class="info">Ø§Ù„Ø®ØµÙ… (10%): <span id="feeVal">0.00</span> Ø¬Ù… | ØµØ§ÙÙŠ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…: <span id="netVal">0.00</span> Ø¬Ù…</div>
    <div class="info">Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©: <span id="needPts">0</span></div>
    <button id="confirmBtn">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø³Ø­Ø¨</button>
    <div id="msg" class="msg"></div>
    <div class="history">
      <h2>ğŸ“œ Ø³Ø¬Ù„ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨ (Ø¢Ø®Ø± 20 Ø·Ù„Ø¨)</h2>
      <table>
        <thead>
          <tr>
            <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
            <th>Ø§Ù„ØµØ§ÙÙŠ</th>
            <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
            <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
          </tr>
        </thead>
        <tbody id="withdrawalsTable"><tr><td colspan="4">Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr></tbody>
      </table>
    </div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey:"AIzaSyBfOJPkWbmcJ6s29bDNysr-H0Kx-Js3Gy0",
      authDomain:"am--rewards.firebaseapp.com",
      projectId:"am--rewards"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    const POINT_VALUE_EGP = 0.07;
    const LIMITS = { min: 20, maxDaily: 200, maxOpsPerDay: 2 };

    // ** Ø¹Ù†Ø§ØµØ± DOM **
    const pointsVal = document.getElementById('pointsVal');
    const egpVal = document.getElementById('egpVal');
    const amountInp = document.getElementById('amountInp');
    const walletVod = document.getElementById('walletVod');
    const feeVal = document.getElementById('feeVal');
    const netVal = document.getElementById('netVal');
    const needPts = document.getElementById('needPts');
    const msg = document.getElementById('msg');
    const withdrawalsTable = document.getElementById('withdrawalsTable');
    const confirmBtn = document.getElementById('confirmBtn');

    let userId = null;
    let currentPoints = 0;
    let referredByUID = null;
    
    // Ø¯Ø§Ù„Ø© ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…
    function formatNum(num) {
      return Number(num || 0).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
    }
    
    // Ø¯Ø§Ù„Ø© ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØªØ§Ø±ÙŠØ®
    function formatDate(ts) {
        if (!ts || !ts.toDate) return "-";
        const dt = ts.toDate();
        if (isNaN(dt)) return "-";
        return dt.toLocaleDateString("ar-EG", { year: 'numeric', month: 'short', day: 'numeric' }) + " " + dt.toLocaleTimeString("ar-EG", { hour: '2-digit', minute: '2-digit' });
    }

    // ** 1. Ù…Ø³ØªÙ…Ø¹ Ø­Ø§Ù„Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© **
    auth.onAuthStateChanged(user => {
      if (user) {
        userId = user.uid;
        
        // Ø¬Ù„Ø¨ Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø§Ø· ÙˆreferredByUID (Realtime)
        db.collection('users').doc(userId).onSnapshot(doc => {
          if (doc.exists) {
            const data = doc.data();
            currentPoints = data.points || 0;
            // Ù†ØªØ±Ùƒ referredByUID Ù‡Ù†Ø§ Ù„Ø£Ù†Ù†Ø§ Ø³Ù†Ø³ØªØ®Ø¯Ù…Ù‡ ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©
            referredByUID = data.referredByUID || null; 

            pointsVal.textContent = formatNum(currentPoints).replace('.00', '');
            egpVal.textContent = formatNum(currentPoints * POINT_VALUE_EGP);
            updateCalc();
          }
        });

        // Ø¬Ù„Ø¨ Ø³Ø¬Ù„ Ø§Ù„Ø³Ø­Ø¨ (Realtime) - (ØªÙ… Ø­Ù„ Ù…Ø´ÙƒÙ„ØªÙ‡ Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙÙ‡Ø±Ø³)
        db.collection("withdrawals").where("userId", "==", user.uid)
          .orderBy("date", "desc")
          .limit(20)
          .onSnapshot(snapshot => {
            withdrawalsTable.innerHTML = "";
            if (snapshot.empty) {
              withdrawalsTable.innerHTML = `<tr><td colspan="4">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø³Ø­Ø¨ Ø¨Ø¹Ø¯</td></tr>`;
              return;
            }
            
            snapshot.forEach(doc => {
              const w = doc.data();
              let statusClass = "", icon = "", statusText = "";
              switch (w.status) {
                case "pending": statusClass = "status-pending"; icon = "â³"; statusText = "Ù…Ø¹Ù„Ù‚"; break;
                case "completed": statusClass = "status-completed"; icon = "âœ…"; statusText = "Ù…ÙƒØªÙ…Ù„"; break;
                case "rejected": statusClass = "status-rejected"; icon = "âŒ"; statusText = "Ù…Ø±ÙÙˆØ¶"; break;
                default: statusText = w.status || "-";
              }
              
              const tr = document.createElement("tr");
              tr.innerHTML = `
                <td>${formatNum(w.amount)} Ø¬Ù…</td>
                <td>${formatNum(w.net)} Ø¬Ù…</td>
                <td class="status ${statusClass}">${icon} ${statusText}</td>
                <td>${formatDate(w.date)}</td>`;
              withdrawalsTable.appendChild(tr);
            });
          }, (error) => {
              // Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø²Ø¡ Ø³ÙŠØ³Ø§Ø¹Ø¯ ÙÙŠ Ø§ÙƒØªØ´Ø§Ù Ù…Ø´ÙƒÙ„Ø© Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø£Ù…Ø§Ù† Ø¥Ø°Ø§ Ø¹Ø§Ø¯Øª Ø§Ù„Ù…Ø´ÙƒÙ„Ø©
              console.error("FIREBASE ERROR: Failed to fetch withdrawals.", error);
              withdrawalsTable.innerHTML = `<tr><td colspan="4" class="error">âŒ ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³Ø¬Ù„. Ø§Ù†Ø¸Ø± Ø§Ù„Ù€ Console Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªÙØ§ØµÙŠÙ„.</td></tr>`;
          });

      } else {
        window.location.href = "index.html";
      }
    });

    // ** 2. Ø¯Ø§Ù„Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±Ø³ÙˆÙ… ÙˆØ§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© **
    function updateCalc() {
      const amt = parseFloat(amountInp.value);
      
      if (isNaN(amt) || amt < LIMITS.min) {
        feeVal.textContent = "0.00"; netVal.textContent = "0.00"; needPts.textContent = "0";
        confirmBtn.disabled = true;
        return;
      }
      
      const fee = amt * 0.10;
      const net = amt - fee;
      const ptsNeeded = Math.ceil(amt / POINT_VALUE_EGP);
      
      feeVal.textContent = formatNum(fee);
      netVal.textContent = formatNum(net);
      needPts.textContent = formatNum(ptsNeeded).replace('.00', '');
      
      if (amt > LIMITS.maxDaily || ptsNeeded > currentPoints) {
        confirmBtn.disabled = true;
      } else {
        confirmBtn.disabled = false;
      }
    }
    amountInp.addEventListener('input', updateCalc);

    // ** 3. Ø¯Ø§Ù„Ø© ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø³Ø­Ø¨ (Ù…Ø¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ø§Ù„Ø¢Ù…Ù†Ø©) **
    confirmBtn.addEventListener('click', async () => {
      msg.textContent = ""; msg.className = "msg";
      const amt = parseFloat(amountInp.value);
      const wallet = walletVod.value.trim();

      // Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø£ÙˆÙ„ÙŠ Ù…Ù† Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª
      if (isNaN(amt) || amt < LIMITS.min || amt > LIMITS.maxDaily) {
        msg.textContent = `âŒ Ø§Ù„Ù…Ø¨Ù„Øº ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨ÙŠÙ† ${LIMITS.min} Ùˆ ${LIMITS.maxDaily} Ø¬Ù….`; 
        msg.classList.add("error"); return; 
      }
      if (!wallet || wallet.length < 11 || !/^\d+$/.test(wallet)) { 
        msg.textContent = "âŒ Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ù…Ø­ÙØ¸Ø© ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´ ØµØ­ÙŠØ­"; 
        msg.classList.add("error"); return; 
      }

      confirmBtn.disabled = true;
      
      try {
        const ptsNeeded = Math.ceil(amt / POINT_VALUE_EGP);
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù‚ÙŠÙˆØ¯ Ø§Ù„ÙŠÙˆÙ… 
        const now = new Date();
        const start = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 0, 0, 0);
        
        // ** Ù…Ù„Ø§Ø­Ø¸Ø©: Ù‡Ø°Ø§ Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù… Ù‚Ø¯ ÙŠØ­ØªØ§Ø¬ ÙÙ‡Ø±Ø³ Ù…Ø±ÙƒØ¨ Ø¢Ø®Ø± ÙÙŠ Firestore Ø¥Ø°Ø§ ÙƒØ§Ù† ÙŠØªØ³Ø¨Ø¨ ÙÙŠ Ø®Ø·Ø£ **
        // (userId, date, Ascending) - Ù„ÙƒÙ† Ø¯Ø¹Ù‡ ÙƒÙ…Ø§ Ù‡Ùˆ Ø­Ø§Ù„ÙŠØ§Ù‹
        const todaySnapshot = await db.collection("withdrawals")
            .where("userId", "==", userId)
            .where("date", ">=", start) 
            .get();
        
        let todayOps = 0, todayAmt = 0;
        todaySnapshot.forEach(doc => {
            const d = doc.data();
            todayOps++; 
            todayAmt += (+d.amount) || 0;
        });
        
        if (todayOps >= LIMITS.maxOpsPerDay) { 
            throw "Ù„Ù‚Ø¯ ÙˆØµÙ„Øª Ù„Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ (2 Ø¹Ù…Ù„ÙŠØ© Ø³Ø­Ø¨ ÙŠÙˆÙ…ÙŠÙ‹Ø§)"; 
        }
        if ((todayAmt + amt) > LIMITS.maxDaily) { 
            throw `Ù„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¬Ø§ÙˆØ² ${LIMITS.maxDaily} Ø¬Ù… ÙŠÙˆÙ…ÙŠÙ‹Ø§`; 
        }
        
        if (!confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø³Ø­Ø¨ ${formatNum(amt)} Ø¬Ù… Ø¥Ù„Ù‰ ${wallet}ØŸ`)) { 
            confirmBtn.disabled = false; return; 
        }
        
        // ** ØªÙ†ÙÙŠØ° Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ø§Ù„Ø¢Ù…Ù†Ø© Ù„Ø®ØµÙ… Ø§Ù„Ù†Ù‚Ø§Ø· ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨ **
        let newWithdrawalDocId = null; 

        await db.runTransaction(async tr => {
          const userRef = db.collection("users").doc(userId);
          const withdrawalRef = db.collection("withdrawals").doc(); 
          
          const snap = await tr.get(userRef);
          const points = snap.data().points || 0;
          
          if (points < ptsNeeded) throw "Ø±ØµÙŠØ¯ Ù†Ù‚Ø§Ø· ØºÙŠØ± ÙƒØ§ÙÙ";
          
          // Ø§Ù„Ø®ØµÙ… Ø¢Ù…Ù† Ù„Ø£Ù†Ù‡ ÙŠØªÙ… ÙÙŠ Transaction Ùˆ Rules ØªØ³Ù…Ø­ Ù„Ù…Ø§Ù„Ùƒ Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ø¨Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
          tr.update(userRef, { points: firebase.firestore.FieldValue.increment(-ptsNeeded) });
          
          tr.set(withdrawalRef, {
            userId, method: "vodafone", wallet,
            amount: amt, fee: amt * 0.10, net: amt - amt * 0.10,
            pts: ptsNeeded, status: "pending",
            date: firebase.firestore.FieldValue.serverTimestamp(),
            referredByUID: referredByUID || null,
            isReferralPaid: false // ÙŠØªÙ… ØªØ±Ùƒ Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ù„ÙŠØ¹Ø±Ù Ø§Ù„Ù…Ø´Ø±Ù Ù„Ø§Ø­Ù‚Ø§Ù‹ Ø£Ù† Ø§Ù„Ø¥Ø­Ø§Ù„Ø© Ù„Ù… ØªØªÙ…
          });

          newWithdrawalDocId = withdrawalRef.id; 
        });

        // ğŸš¨ğŸš¨ğŸš¨ Ù…Ù†Ø·Ù‚ Ø§Ù„Ø¥Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¤Ù‚Øª ÙˆØºÙŠØ± Ø§Ù„Ø¢Ù…Ù† ğŸš¨ğŸš¨ğŸš¨
        // ğŸ›‘ğŸ›‘ ØªÙ… ØªØ¹Ø·ÙŠÙ„ Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø²Ø¡ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ø­Ù„ Ù…Ø´ÙƒÙ„Ø© 'failed-precondition' ğŸ›‘ğŸ›‘
        /*
        if (referredByUID && newWithdrawalDocId) {
            const inviterRef = db.collection("users").doc(referredByUID);
            const withdrawalRef = db.collection("withdrawals").doc(newWithdrawalDocId);
            const bonusPoints = Math.floor(amt * 0.10 * (1 / POINT_VALUE_EGP));
            
            if (bonusPoints > 0) {
                await Promise.all([
                    inviterRef.update({
                        points: firebase.firestore.FieldValue.increment(bonusPoints),
                        referralPoints: firebase.firestore.FieldValue.increment(bonusPoints),
                        lastReferralUpdateDate: firebase.firestore.FieldValue.serverTimestamp()
                    }),
                    
                    withdrawalRef.update({
                        isReferralPaid: true,
                        referralBonusAmount: bonusPoints
                    })
                ]);
            }
        }
        */
        // ğŸš¨ğŸš¨ğŸš¨ Ù†Ù‡Ø§ÙŠØ© Ù…Ù†Ø·Ù‚ Ø§Ù„Ø¥Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¤Ù‚Øª ÙˆØºÙŠØ± Ø§Ù„Ø¢Ù…Ù† ğŸš¨ğŸš¨ğŸš¨
        
        msg.textContent = "âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨ Ø¨Ù†Ø¬Ø§Ø­. â³ Ø¬Ø§Ø±Ù Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©.";
        msg.classList.add("success");
        amountInp.value = ""; walletVod.value = "";
        updateCalc();

      } catch (err) {
        // âŒâŒ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ù…Ø­Ø³Ù‘Ù†Ø© Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø¨Ø¯Ù‚Ø© ÙÙŠ Ø§Ù„Ù€ Console âŒâŒ
        console.error("FATAL WITHDRAWAL ERROR:", err); 
        let errorMsg;

        if (typeof err === 'string') {
          errorMsg = err; 
        } else if (err.code) {
             // Ø£Ø®Ø·Ø§Ø¡ Firebase (Ù…Ø«Ù„ 'permission-denied' Ø£Ùˆ 'failed-precondition')
            errorMsg = `Ø®Ø·Ø£ ÙÙŠ Firebase: ${err.code}`;
        } else {
          errorMsg = "Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹. Ø­Ø§ÙˆÙ„ Ù…Ø¬Ø¯Ø¯Ø§Ù‹.";
        }
        
        msg.textContent = "âŒ " + errorMsg; 
        msg.classList.add("error");
      } finally {
        confirmBtn.disabled = false;
      }
    });
  </script>
</body>
</html>
