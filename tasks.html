<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <title>المهام اليومية | Am Rewards</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="https://fonts.googleapis.com/css2?family=Tajawal&display=swap" rel="stylesheet" />
    <style>
      body {
        font-family: 'Tajawal', sans-serif;
        margin: 0;
        padding: 20px;
        background-color: #f4f4f4;
        color: #333;
      }
      h1 {
        text-align: center;
        margin-bottom: 20px;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        background: #fff;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      }
      th, td {
        padding: 12px 15px;
        text-align: center;
        border-bottom: 1px solid #eee;
      }
      th {
        background-color: #009688;
        color: white;
      }
      tr:hover {
        background-color: #f1f1f1;
      }
    </style>
  </head>
  <body>
    <h1>المهام اليومية</h1>
    <table>
      <thead>
        <tr>
          <th>المهمة</th>
          <th>العدد</th>
          <th>النقطة لكل مهمة</th>
          <th>الإجمالي</th>
          <th>ربح المستخدم</th>
          <th>ربحك</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>روابط مختصرة (CPL)</td><td>70</td><td>1.5</td><td>105</td><td>7.35 جنيه</td><td>14 جنيه</td></tr>
        <tr><td>أدوات AI + تجربة</td><td>40</td><td>4</td><td>160</td><td>11.2 جنيه</td><td>18 جنيه</td></tr>
        <tr><td>عروض CPA مربحة</td><td>35</td><td>10</td><td>350</td><td>24.5 جنيه</td><td>40 جنيه</td></tr>
        <tr><td>تثبيت تطبيقات</td><td>25</td><td>15</td><td>375</td><td>26.25 جنيه</td><td>35 جنيه</td></tr>
        <tr><td>استكشاف مواقع</td><td>30</td><td>3</td><td>90</td><td>6.3 جنيه</td><td>10 جنيه</td></tr>
        <tr><td>استطلاعات رأي (CPX + إضافات)</td><td>15</td><td>20</td><td>300</td><td>21 جنيه</td><td>30 جنيه</td></tr>
        <tr><td>مشاهدات فيديو قصيرة</td><td>10</td><td>2</td><td>20</td><td>1.4 جنيه</td><td>2.5 جنيه</td></tr>
        <tr><td>استبيان رأي عن الموقع</td><td>10</td><td>4</td><td>40</td><td>2.8 جنيه</td><td>0 جنيه</td></tr>
        <tr><td>تصويت على المهام</td><td>10</td><td>3</td><td>30</td><td>2.1 جنيه</td><td>0 جنيه</td></tr>
        <tr><td>مكافأة إتمام كل المهام</td><td>1</td><td>300</td><td>300</td><td>21 جنيه</td><td>0 جنيه</td></tr>
      </tbody>
    </table>

    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
      import {
        getAuth,
        onAuthStateChanged,
      } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
      import {
        getDatabase,
        ref,
        get,
        update,
      } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

      const firebaseConfig = {
        apiKey: "AIzaSyBfOJPkWbmcJ6s29bDNysr-H0Kx-Js3Gy0",
        authDomain: "am--rewards.firebaseapp.com",
        databaseURL: "https://am--rewards-default-rtdb.firebaseio.com",
        projectId: "am--rewards",
        storageBucket: "am--rewards.appspot.com",
        messagingSenderId: "744783579735",
        appId: "1:744783579735:web:45e00de9998893bbc9b112",
        measurementId: "G-CV3GLT2TTJ"
      };

      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      const database = getDatabase(app);

      onAuthStateChanged(auth, (user) => {
        if (user) {
          const userId = user.uid;
          const pointsRef = ref(database, 'users/' + userId + '/points');

          get(pointsRef).then((snapshot) => {
            let currentPoints = snapshot.exists() ? snapshot.val() : 0;
            let totalNewPoints = 105 + 160 + 350 + 375 + 90 + 300 + 20 + 40 + 30 + 300;

            update(ref(database, 'users/' + userId), {
              points: currentPoints + totalNewPoints
            });
          });
        }
      });
    </script>
  </body>
  </html>
