<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <title>Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ | Am Rewards</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&family=Montserrat:wght@700&display=swap" rel="stylesheet">
  <style>
    /* ... (Ø¬Ù…ÙŠØ¹ Ø£ÙƒÙˆØ§Ø¯ CSS ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ) ... */
    :root{  
      --accent:#FFD369;  
      --accent-2:#34d399;  
      --primary-bg: #05132f;  
      --card-bg: rgba(12,18,40,0.82);  
      --glass-bg: rgba(255,255,255,0.10);  
      --glass-border: rgba(255,255,255,0.17);  
      --muted: #b8c2cf;  
      --error: #ff6b6b;  
      --success: #4ade80;  
      --shadow: 0 8px 32px 0 rgba(2,6,23,0.35);  
      --radius: 22px;  
    }  
    *{box-sizing:border-box}  
    html, body{  
      margin:0;  
      padding:0;  
    }  
    body{  
      font-family:"Cairo", "Montserrat", sans-serif;  
      color:#f1f6fb;  
      min-height:100vh;  
      background:  
        linear-gradient(120deg, #0f2027 0%, #2c5364 100%),  
        url('https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=1500&q=80');  
      background-size:cover;  
      background-attachment:fixed;  
      background-blend-mode:overlay;  
      display:flex;  
      align-items:flex-start;  
      justify-content:center;  
      padding:20px 0; 
    }  
    /* ... (Ø¨Ù‚ÙŠØ© Ø§Ù„Ù€ CSSs) ... */

    /* Animated overlay */  
    .animated-bg {  
      position:fixed;  
      inset:0;  
      z-index:0;  
      pointer-events:none;  
      background: radial-gradient(circle at 70% 15%, rgba(52,211,153,0.07) 0%, transparent 60%),  
                  radial-gradient(circle at 20% 85%, rgba(255,211,105,0.09) 0%, transparent 60%);  
      animation: movebg 14s cubic-bezier(.4,0,.2,1) infinite alternate;  
    }  
    @keyframes movebg {  
      0% { background-position: 70% 15%, 20% 85%;}  
      100% { background-position: 65% 35%, 35% 80%;}  
    }  
    /* Main container */  
    .center-wrap{  
      width:100%;  
      max-width:1150px;  
      display:grid;  
      grid-template-columns: 1.2fr 1fr;  
      gap:42px;  
      align-items:stretch;  
      z-index:2;  
      margin:42px 0;  
      background: rgba(255,255,255,0.02);  
      border-radius: var(--radius);  
      box-shadow: var(--shadow);  
      overflow:hidden;  
    }  

    /* Left hero */  
    .hero{  
      background:var(--card-bg);  
      padding:54px 38px 44px 38px;  
      display:flex;  
      flex-direction:column;  
      justify-content:center;  
      border-top-right-radius: var(--radius);  
      border-bottom-right-radius: var(--radius);  
      box-shadow: 0 0 32px 0 rgba(52,211,153,0.03);  
      position:relative;  
      overflow:hidden;  
    }  
    .hero h2{  
      font-family:"Montserrat", "Cairo", sans-serif;  
      font-size:38px;  
      color:var(--accent);  
      margin:0 0 16px 0;  
      letter-spacing:1.2px;  
      font-weight:800;  
      text-shadow: 0 2px 18px rgba(255,211,105,0.13);  
    }  
    .hero p{  
      color:var(--muted);  
      font-size:16.5px;  
      line-height:1.7;  
      margin-bottom:22px;  
      max-width:580px;  
    }  
    .bullets{  
      display:flex;flex-direction:column;gap:13px;margin-bottom:24px;  
    }  
    .bullet{  
      display:flex;align-items:center;gap:12px;  
      font-size:17px;  
      color:#e5f7ff;  
    }  
    .dot{  
      width:13px;height:13px;border-radius:50%;  
      background:linear-gradient(90deg,var(--accent),var(--accent-2));  
      box-shadow:0 2px 8px rgba(0,0,0,0.13);  
      border:2.5px solid #fff2;  
    }  
    .cta .btn-ghost{  
      background:transparent;  
      border:1.5px solid var(--accent);  
      padding:13px 26px;  
      border-radius:13px;  
      color:var(--accent);  
      font-weight:700;  
      font-size:15px;  
      cursor:pointer;  
      transition:background .12s, color .12s;  
      margin-top:12px;  
      box-shadow: 0 4px 22px rgba(255,211,105,0.09);  
    }  
    .cta .btn-ghost:hover {  
      background:var(--accent); color:#222;  
    }  

    /* Signup Card */  
    .signup-card{  
      background:var(--glass-bg);  
      border:1.5px solid var(--glass-border);  
      border-radius: var(--radius);  
      padding:38px 32px 24px 32px;  
      box-shadow: 0 10px 60px 0 rgba(2,6,23,0.37);  
      min-width:350px;  
      display:flex;  
      flex-direction:column;  
      align-items:center;  
      position:relative;  
      z-index:1;  
      backdrop-filter: blur(16px) saturate(120%);  
    }  
    .signup-card h3{  
      margin:16px 0 10px 0;
      text-align:center;  
      color:#e6f7ff;  
      font-size:24px;  
      font-family:"Montserrat", "Cairo", sans-serif;  
      font-weight:700;  
      letter-spacing:0.8px;  
    }  
    .signup-card p.lead{  
      margin:0 0 18px 0;  
      color:var(--muted);  
      text-align:center;  
      font-size:15px;  
    }  

    .form-row{display:flex;flex-direction:column;gap:13px;margin-top:8px;width:100%;}  
    label{font-size:14px;color:var(--muted);text-align:right}  
    .input-wrapper { 
        position: relative; 
        width: 100%;
    }
    input[type="text"], input[type="email"], input[type="password"]{  
      width:100%;  
      padding:13px 15px;  
      border-radius:12px;  
      border:1.5px solid rgba(255,255,255,0.15);  
      background: rgba(32,40,74,0.32);  
      color:#fff;  
      font-size:15.5px;  
      font-family:"Cairo",sans-serif;  
      transition:box-shadow .18s, border-color .18s, transform .12s;  
      outline:none;  
      margin-top:4px;  
    }  
    input:focus{  
      box-shadow: 0 6px 20px rgba(52,211,153,0.08), 0 0 12px rgba(255,215,105,0.07) inset;  
      border-color: var(--accent-2);  
      transform: translateY(-1px) scale(1.01);  
      background: rgba(32,40,74,0.48);  
    }  
    
    /* ØªØµÙ…ÙŠÙ… Ø²Ø± Ø¥Ø¸Ù‡Ø§Ø± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± */
    .toggle-password {
        position: absolute;
        left: 15px;
        top: 50%;
        transform: translateY(-50%);
        cursor: pointer;
        color: var(--muted);
        font-size: 18px;
        transition: color 0.15s;
    }
    .toggle-password:hover {
        color: var(--accent-2);
    }
    .eye-icon::after {
        content: 'ğŸ‘ï¸'; 
    }
    .eye-icon.visible::after {
        content: 'ğŸ™ˆ'; 
    }

    .checkbox-row{  
      display:flex;  
      gap:9px;  
      align-items:center;  
      margin-top:10px;  
      width:100%;  
      justify-content:flex-start;  
    }  
    .checkbox-row input{width:19px;height:19px;accent-color:var(--accent);}  
    .checkbox-row label{font-size:14px;}  

    .btn-primary{  
      margin-top:18px;  
      width:100%;  
      padding:14px 0;  
      border-radius:13px;  
      border:0;  
      color:#0b1320;  
      background:linear-gradient(90deg,var(--accent),var(--accent-2) 80%);  
      font-weight:900;  
      font-size:17px;  
      cursor:pointer;  
      box-shadow: 0 8px 32px rgba(255,215,105,0.12), 0 2px 16px rgba(52,211,153,0.06);  
      transition: transform .14s cubic-bezier(.4,0,.2,1), box-shadow .14s;  
      font-family:"Montserrat", "Cairo",sans-serif;  
    }  
    .btn-primary:active{ transform: translateY(1px) }  
    .btn-primary[disabled]{opacity:0.6;cursor:not-allowed;transform:none}  

    .text-muted{color:var(--muted);font-size:13px;margin-top:10px;text-align:center}  
    .links{display:flex;gap:8px;justify-content:center;margin-top:18px}  
    .links a{color:var(--accent-2);text-decoration:none;font-weight:700;transition:color .13s;}  
    .links a:hover{color:var(--accent);}  

    .status { min-height:20px;margin-top:12px;text-align:center;font-size:15px;font-weight:600;}  
    .status.error{ color:var(--error) }  
    .status.success{ color:var(--success) }  

    footer.small{  
      margin-top:20px;text-align:center;color:#9fb0c8;font-size:13px;opacity:0.7;  
    }  

    /* Responsive */  
    @media(max-width:1100px){  
      .center-wrap{grid-template-columns:1fr;max-width:720px;}  
      .hero{border-radius: var(--radius) var(--radius) 0 0; min-height:220px;}  
      .signup-card{border-radius: 0 0 var(--radius) var(--radius);}  
    }  
    @media(max-width:600px){  
      .center-wrap{max-width:96vw;}  
      .hero{padding:26px 12px 20px 12px;}  
      .signup-card{padding:18px 7vw 18px 7vw;}  
    }  
    @media(max-width:420px){  
      .center-wrap{gap:3px;}  
      .hero h2{font-size:22px}  
      .signup-card h3{font-size:18px;}  
      .signup-card{padding:10px 1vw;}  
    }

    /* --- Modal Styles (Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…) --- */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(8px);
      z-index: 1000;
      display: flex;
      justify-content: center;
      align-items: center;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s ease-in-out;
    }
    .modal-overlay.open {
      opacity: 1;
      pointer-events: auto;
    }
    .modal-content {
      background: var(--card-bg);
      border: 1.5px solid var(--glass-border);
      border-radius: var(--radius);
      padding: 30px;
      width: 90%;
      max-width: 650px;
      max-height: 85vh;
      overflow-y: auto;
      transform: scale(0.9);
      transition: transform 0.2s ease-in-out;
    }
    .modal-overlay.open .modal-content {
      transform: scale(1);
    }
    .modal-content h1 {
      font-size: 24px;
      color: var(--accent-2);
      margin-top: 0;
    }
    .modal-content ul {
      list-style: none;
      padding: 0;
      margin: 15px 0;
    }
    .modal-content li {
      font-size: 15px;
      line-height: 1.6;
      margin-bottom: 10px;
      position: relative;
      padding-right: 18px;
      color: var(--muted);
    }
    .modal-content li::before {
      content: 'âœ“';
      position: absolute;
      right: 0;
      color: var(--accent);
      font-weight: 900;
      font-size: 17px;
    }
    .modal-content .note {
      margin-top: 20px;
      padding: 10px;
      background: rgba(255, 211, 105, 0.1);
      border-radius: 8px;
      font-size: 14px;
      color: var(--accent);
      text-align: center;
    }
    .modal-close {
      float: left;
      background: var(--error);
      color: white;
      border: none;
      padding: 8px 18px;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 700;
      margin-top: 20px;
      transition: background 0.15s;
    }
    .modal-close:hover {
      background: #d64a4a;
    }
  </style>
</head>
<body>
  <div class="animated-bg" aria-hidden="true"></div>
  <div class="center-wrap" role="main">
    <div class="hero" aria-hidden="false">
      <h2>Am Rewards<span style="color:#fff;font-size:13px;"> â€” Ø§Ø±Ø¨Ø­ Ø¨Ø«Ù‚Ø©</span></h2>
      <p>Ù…Ù†ØµØ© Ù…ÙƒØ§ÙØ¢Øª Ø­Ø¯ÙŠØ«Ø© ØªØ¬Ù…Ø¹ Ø¨ÙŠÙ† Ø§Ù„Ø´ÙØ§ÙÙŠØ©ØŒ Ø§Ù„Ø£Ù…Ø§Ù† ÙˆØ³Ù‡ÙˆÙ„Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…. Ø£ÙƒØ³Ø¨ Ù†Ù‚Ø§Ø·Ùƒ Ø¨ÙˆØ¶ÙˆØ­ØŒ Ø§Ø³Ø­Ø¨Ù‡Ø§ Ø¨Ø³Ø±Ø¹Ø©ØŒ ÙˆØ´Ø§Ø±Ùƒ Ø£ØµØ¯Ù‚Ø§Ø¡Ùƒ Ø¨Ù†Ø¸Ø§Ù… Ø¥Ø­Ø§Ù„Ø§Øª Ù…ØªØ·ÙˆØ± ÙŠÙ…Ù†Ø¹ Ø§Ù„ØªÙ„Ø§Ø¹Ø¨.</p>
      <div class="bullets" aria-hidden="true">
        <div class="bullet"><span class="dot"></span><div>Ø³Ø­Ø¨ Ø³Ø±ÙŠØ¹ ÙˆØ¢Ù…Ù† Ø¨Ø¶ØºØ·Ø© ÙˆØ§Ø­Ø¯Ø©</div></div>
        <div class="bullet"><span class="dot"></span><div>Ù…Ù‡Ø§Ù… ÙŠÙˆÙ…ÙŠØ© Ù…ØªÙ†ÙˆØ¹Ø© â€” Ø§Ø±Ø¨Ø­ ÙˆÙ‚ØªÙ…Ø§ ØªØ´Ø§Ø¡</div></div>
        <div class="bullet"><span class="dot"></span><div>Ù†Ø¸Ø§Ù… Ø¥Ø­Ø§Ù„Ø§Øª Ø´ÙØ§Ù (Ù„Ù„ÙØ±Ù‚ ÙÙ‚Ø·)</div></div>
      </div>
      <div class="cta">
        <button class="btn-ghost" type="button" onclick="document.querySelector('.signup-card').scrollIntoView({behavior: 'smooth'})">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù† â€” Ø³Ø¬Ù‘Ù„ Ø­Ø³Ø§Ø¨Ùƒ</button>
      </div>
    </div>
    <form class="signup-card" onsubmit="event.preventDefault(); signup();" aria-labelledby="signupTitle">
      <h3 id="signupTitle">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</h3>
      <p class="lead">Ø³Ø¬Ù‘Ù„ ÙˆØ§Ù†Ø¶Ù… Ù„Ù…Ù†ØµØ© Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª Ø§Ù„Ø£Ø³Ø±Ø¹ Ù†Ù…ÙˆØ§Ù‹ ÙÙŠ Ù…ØµØ±</p>
      
      <div class="form-row">
        <label for="name">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
        <input id="name" type="text" placeholder="Ø§Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„" autocomplete="name" required />
        
        <label for="phone">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ (Ù…ØµØ±)</label>
        <input id="phone" type="text" placeholder="01xxxxxxxxx" inputmode="numeric" autocomplete="tel" required maxlength="11" />
        
        <label for="email">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
        <input id="email" type="email" placeholder="example@mail.com" autocomplete="email" required />
        
        <label for="password">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
        <div class="input-wrapper">
            <input id="password" type="password" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± (6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„)" autocomplete="new-password" required />
            <span class="toggle-password eye-icon" onclick="togglePasswordVisibility('password')"></span>
        </div>
        
        <label for="confirmPassword">ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
        <div class="input-wrapper">
            <input id="confirmPassword" type="password" placeholder="Ø£Ø¹Ø¯ ÙƒØªØ§Ø¨Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" autocomplete="new-password" required />
            <span class="toggle-password eye-icon" onclick="togglePasswordVisibility('confirmPassword')"></span>
        </div>

        <label for="refCode">ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø­Ø§Ù„Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
        <input id="refCode" type="text" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø§Ø¹ÙŠ Ù‡Ù†Ø§ (ÙŠÙ…Ù„Ø£ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹)" autocomplete="off" />

      </div>
      
      <div class="checkbox-row" aria-hidden="false">
        <input id="agree" type="checkbox" required />
        <label for="agree" class="text-muted">
          Ø£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ <a href="#" id="viewPolicyLink" style="color:var(--accent); text-decoration: underline;">Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</a>
        </label>
      </div>
      <button id="signupBtn" class="btn-primary" type="submit">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ â€” Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†</button>
      <div id="status" class="status" role="status" aria-live="polite"></div>
      <div class="links">
        <a href="login.html">Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</a>
      </div>
      <footer class="small">Â© 2025 Am Rewards â€” Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</footer>
    </form>
  </div>

  <div id="policyModal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="policyTitle">
    <div class="modal-content">
      <h1 id="policyTitle">Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</h1>
      <ul style="list-style: none; padding: 0;">
        <li>ÙŠÙØ­Ø¸Ø± ØªÙ…Ø§Ù…Ù‹Ø§ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£ÙŠ ÙˆØ³Ø§Ø¦Ù„ Ø£Ùˆ Ø£Ø¯ÙˆØ§Øª Ø¨Ø±Ù…Ø¬ÙŠØ© ØºÙŠØ± Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© Ù…Ø«Ù„ Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„ØªÙƒØ±Ø§Ø± Ø£Ùˆ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù‚Ø§Ø·.</li>
        <li>ÙŠØ¬Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ø­Ø¨ Ø¨Ø¯Ù‚Ø©ØŒ ÙˆØ£ÙŠ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø²ÙŠÙØ© ØªØ¤Ø¯ÙŠ Ø¥Ù„Ù‰ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø­Ø³Ø§Ø¨ Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§.</li>
        <li>ÙŠØ³Ù…Ø­ Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ ÙˆØ§Ø­Ø¯ ÙÙ‚Ø· Ù„ÙƒÙ„ Ø´Ø®Øµ. Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ù…ÙƒØ±Ø±Ø© ÙŠØªÙ… Ø­Ø¸Ø±Ù‡Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¯ÙˆÙ† Ø¥Ù†Ø°Ø§Ø±.</li>
        <li>Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø¹Ù…Ù„ÙŠØªÙŠ Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„ÙŠÙˆÙ…ÙŠØ© Ù‡Ùˆ <strong>200 Ø¬Ù†ÙŠÙ‡ Ù…ØµØ±ÙŠ</strong>ØŒ ÙˆÙŠØªÙ… Ø®ØµÙ… <strong>10%</strong> Ø±Ø³ÙˆÙ… Ø¥Ø¯Ø§Ø±ÙŠØ© Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø­Ø¨.</li>
        <li>ÙŠÙÙ…Ù†Ø¹ Ø§Ø³ØªØºÙ„Ø§Ù„ Ø§Ù„Ø«ØºØ±Ø§Øª Ø£Ùˆ Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„ØªÙ„Ø§Ø¹Ø¨ Ø¨Ø§Ù„Ù†Ø¸Ø§Ù…ØŒ ÙˆÙŠØªÙ… Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ ØªÙ„Ùƒ Ø§Ù„Ø­Ø§Ù„Ø§Øª Ø¨ØµØ±Ø§Ù…Ø©.</li>
        <li>ÙŠØ­Ù‚ Ù„Ù„Ø¥Ø¯Ø§Ø±Ø© ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø´Ø±ÙˆØ· Ø£Ùˆ Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª ÙÙŠ Ø£ÙŠ ÙˆÙ‚Øª Ø¯ÙˆÙ† Ø§Ù„Ø­Ø§Ø¬Ø© Ù„Ø¥Ø´Ø¹Ø§Ø± Ù…Ø³Ø¨Ù‚.</li>
        <li>Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù…Ùƒ Ù„Ù…ÙˆÙ‚Ø¹ Am RewardsØŒ ÙØ¥Ù†Ùƒ ØªÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø³ÙŠØ§Ø³Ø§Øª Ø§Ù„Ù…Ø°ÙƒÙˆØ±Ø© Ø£Ø¹Ù„Ø§Ù‡.</li>
      </ul>
      <div class="note">
        <span>Ø³Ø¹Ø± Ø§Ù„Ù†Ù‚Ø·Ø© Ø­Ø§Ù„ÙŠØ§Ù‹: 0.07 Ø¬Ù†ÙŠÙ‡ Ù…ØµØ±ÙŠ. ØªØ·Ø¨Ù‘Ù‚ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ© ÙˆØ§Ù„Ù…Ù‡Ø§Ù… Ø¯Ø§Ø®Ù„ Ø§Ù„Ù†Ø¸Ø§Ù….</span>
      </div>
      <button class="modal-close" onclick="document.getElementById('policyModal').classList.remove('open')">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>
  </div>
  
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    import { getFirestore, doc, setDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
    
    // ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ù‡Ø°Ù‡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØµØ­ÙŠØ­Ø©
    const firebaseConfig = {  
      apiKey: "AIzaSyBfOJPkWbmcJ6s29bDNysr-H0Kx-Js3Gy0",  
      authDomain: "am--rewards.firebaseapp.com",  
      projectId: "am--rewards",  
      storageBucket: "am--rewards.appspot.com",  
      messagingSenderId: "428582312150",  
      appId: "1:428582312150:web:44e35a70e457e7db4c45df"  
    };  

    const app = initializeApp(firebaseConfig);  
    const auth = getAuth(app);  
    const db = getFirestore(app);  

    const urlParams = new URLSearchParams(window.location.search);  
    const initialReferralCode = urlParams.get("ref");  
    const refCodeInput = document.getElementById('refCode');
    if (initialReferralCode) {
        refCodeInput.value = initialReferralCode.toUpperCase().trim();
        refCodeInput.readOnly = true; 
    }

    const statusEl = document.getElementById('status');  
    const signupBtn = document.getElementById('signupBtn');  
    
    const policyModal = document.getElementById('policyModal');
    const viewPolicyLink = document.getElementById('viewPolicyLink');

    viewPolicyLink.addEventListener('click', (e) => {
        e.preventDefault();
        policyModal.classList.add('open');
    });
    
    const getVal = (id) => document.getElementById(id).value.trim();  

    function setStatus(text, type='info'){  
      statusEl.textContent = text || '';  
      statusEl.className = 'status ' + (type==='error' ? 'error' : (type==='success'? 'success':''));  
    }  

    window.togglePasswordVisibility = function(id) {
        const input = document.getElementById(id);
        const icon = input.nextElementSibling;
        
        if (input.type === "password") {
            input.type = "text";
            icon.classList.add('visible');
        } else {
            input.type = "password";
            icon.classList.remove('visible');
        }
    }

    function validateSignupData(data) {  
        if (!data.name || !data.phone || !data.email || !data.password || !data.confirmPassword) {  
            return 'âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©.';  
        }  
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø³Ù… (Ø­Ø±ÙˆÙ Ø¹Ø±Ø¨ÙŠØ© Ø£Ùˆ Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© ÙˆÙ…Ø³Ø§ÙØ§Øª ÙÙ‚Ø·)
        if (!/^[\u0600-\u06FFa-zA-Z\s]+$/.test(data.name)) {
            return 'âš ï¸ Ø§Ù„Ø§Ø³Ù… ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø­Ø±ÙˆÙ ÙÙ‚Ø· (Ø¨Ø¯ÙˆÙ† Ø±Ù…ÙˆØ² Ø£Ùˆ Ø£Ø±Ù‚Ø§Ù…).';
        }
        if (!/^01[0-9]{9}$/.test(data.phone)) {  
            return 'âš ï¸ Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ù…ØµØ±ÙŠ ØµØ­ÙŠØ­ (11 Ø±Ù‚Ù… ÙˆÙŠØ¨Ø¯Ø£ Ø¨Ù€01).';  
        }  
        if (data.password.length < 6) {  
            return 'âš ï¸ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù‚ØµÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ (Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ 6 Ø£Ø­Ø±Ù).';  
        }  
        if (data.password !== data.confirmPassword) {  
            return 'âš ï¸ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙˆØªØ£ÙƒÙŠØ¯Ù‡Ø§ ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚ÙŠÙ†.';  
        }  
        if (!document.getElementById("agree").checked) {  
            return 'âš ï¸ ÙŠØ¬Ø¨ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù….';  
        }  
        return null; 
    }  

    // ğŸŒŸ Ø¯Ø§Ù„Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø¹Ø±Ù Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„ÙØ±ÙŠØ¯
    function generateOrGetDeviceId() {
        let deviceId = localStorage.getItem('appDeviceId');
        if (!deviceId) {
            deviceId = (window.crypto?.randomUUID) ? window.crypto.randomUUID() : Math.random().toString(36).substring(2) + Date.now().toString(36);
            localStorage.setItem('appDeviceId', deviceId);
        }
        return deviceId;
    }
    
    // ----------------------------------------------------------------------
    // ğŸ¯ Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ø§Ù„Ù…ÙØ¹Ø¯Ù„Ø© (Ø§Ù„ØªØ­Ù‚Ù‚ Ø«Ù… Ø§Ù„ØªØ£ÙƒÙŠØ¯)
    // ----------------------------------------------------------------------
    async function signup(){  
      setStatus('', 'info');  

      const password = document.getElementById("password").value;
      
      const data = {  
          name: getVal("name"),  
          phone: getVal("phone"),  
          email: getVal("email"),  
          password: password, 
          confirmPassword: getVal("confirmPassword"),  
      };  
      
      const referralCode = getVal("refCode") || ""; 
      const currentDeviceId = generateOrGetDeviceId(); 

      const validationError = validateSignupData(data);  
      if (validationError) {  
          setStatus(validationError, 'error');  
          return;  
      }  

      signupBtn.disabled = true;  
      signupBtn.textContent = 'â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø£Ù…Ù†ÙŠ...';  

      try {  
        // 1. ğŸ›¡ï¸ Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø£Ù…Ù†ÙŠ Ø¹Ø¨Ø± Ø§Ù„Ù€ Backend (IP/DeviceID/Email)
        const secureCheckResponse = await fetch('/api/secureSignup', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                email: data.email,
                deviceId: currentDeviceId, 
            }),
        });

        const secureCheckResult = await secureCheckResponse.json();

        if (!secureCheckResponse.ok || !secureCheckResult.approved) {
            // ÙØ´Ù„ Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø£Ù…Ù†ÙŠ (IP Ù…Ø³ØªØ®Ø¯Ù…ØŒ Ø§Ù„Ø¬Ù‡Ø§Ø² Ù…Ø³Ø¬Ù„ØŒ Ø£Ùˆ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ù…Ø³ØªØ®Ø¯Ù…)
            const reason = secureCheckResult.reason || 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø£Ù…Ù†ÙŠ';
            const errorCode = secureCheckResult.errorCode || 'BACKEND_CHECK_FAILED';
            
            console.error(`Backend Security Check Failed (${errorCode}):`, secureCheckResult);

            let displayReason = reason;
            if (errorCode === 'EMAIL_ALREADY_USED') {
                displayReason += `. <a href="login.html" style="color:var(--accent-2);text-decoration:underline;">Ø¬Ø±Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</a> Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø°Ù„Ùƒ.`;
                statusEl.innerHTML = `âŒ ÙØ´Ù„ Ø§Ù„ØªØ³Ø¬ÙŠÙ„: ${displayReason}`;
                statusEl.className = 'status error';
            } else {
                 setStatus(`âŒ ÙØ´Ù„ Ø§Ù„ØªØ³Ø¬ÙŠÙ„: ${displayReason}`, 'error');
            }
            return;
        }

        // 2. ğŸ”‘ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Firebase Auth (Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„ØªÙŠ Ù‚Ø¯ ØªÙØ´Ù„ ÙÙŠ Ø§Ù„Ù…Ù†ØªØµÙ)
        signupBtn.textContent = 'â³ ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚. Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨...'; 
        
        const userCredential = await createUserWithEmailAndPassword(auth, data.email, password);  
        const user = userCredential.user;  
        const uid = user.uid;  
        
        // 3. ğŸ’¾ ØªØ³Ø¬ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Firestore
        const myReferralCode = uid.slice(0,6).toUpperCase();  
        
        const setUserDocPromise = setDoc(doc(db, "users", uid), {  
          uid,  
          name: data.name,  
          email: data.email,  
          phone: data.phone,  
          points: 0,  
          referralPoints: 0,  
          referralCount: 0,  
          referralCode: myReferralCode,  
          referralBy: referralCode, 
          deviceId: currentDeviceId, 
          totalWithdrawn: 0,  
          dailyWithdrawAmount: 0,  
          isBanned: false,  
          lastWithdrawlDate: "",  
          joinedAt: serverTimestamp(),
        });  

        // 4. ğŸ”— ØªØ£ÙƒÙŠØ¯ Ø­Ø¬Ø² Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ ÙÙŠ Ø§Ù„Ù€ Backend (Ø§Ù„Ø¢Ù† Ø¢Ù…Ù†Ø© Ù…Ù† Ø§Ù„ÙØ´Ù„ Ø§Ù„Ø¬Ø²Ø¦ÙŠ)
        const confirmDevicePromise = fetch('/api/confirmDevice', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                email: data.email,
                deviceId: currentDeviceId,
            }),
        });

        // Ø§Ù†ØªØ¸Ø± Ù†Ø¬Ø§Ø­ ÙƒÙ„ØªØ§ Ø§Ù„Ø¹Ù…Ù„ÙŠØªÙŠÙ† (Firestore Ùˆ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¬Ù‡Ø§Ø²)
        await Promise.all([setUserDocPromise, confirmDevicePromise]);


        // 5. âœ… Ø§Ù„Ù†Ø¬Ø§Ø­ ÙˆØ§Ù„ØªÙˆØ¬ÙŠÙ‡
        setStatus('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­! Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡...', 'success');  
        setTimeout(()=> window.location.replace('dashboard.html'), 1400);  

      } catch (err) {  
        console.error('Signup Error:', err);  
        let errMsg;
        
        // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø®Ø·Ø£ "Ø§Ù„Ø¨Ø±ÙŠØ¯ Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„" Ø¥Ø°Ø§ Ø­Ø¯Ø« Ø¨Ø¹Ø¯ Ø®Ø·ÙˆØ© Ø§Ù„Ù€ Backend
        if (err.code === 'auth/email-already-in-use') {
            errMsg = `âŒ Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„. <a href="login.html" style="color:var(--accent-2);text-decoration:underline;">Ø¬Ø±Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</a> Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø°Ù„Ùƒ.`;
            statusEl.innerHTML = errMsg;
            statusEl.className = 'status error';
        } else {
             errMsg = (err && err.message ? 'âŒ ' + err.message : 'âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨');
             setStatus(errMsg, 'error');
        }
                       
      } finally {
        signupBtn.disabled = false;  
        signupBtn.textContent = 'Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ â€” Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†';  
      }
    }
  </script>
</body>
</html>

