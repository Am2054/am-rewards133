<!DOCTYPE html>  
<html lang="ar" dir="rtl">    
<head>        
  <meta charset="UTF-8" />      
  <title>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ - Am Rewards</title>      
  <meta name="viewport" content="width=device-width, initial-scale=1" />      
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&family=Montserrat:wght@700&display=swap" rel="stylesheet">      
  <style>      
    :root{        
      --main-gradient: linear-gradient(135deg, #1e3c72 0%, #2a5298 60%, #38bdf8 100%);        
      --dark-box-bg: rgba(2,6,23,0.95); /* Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ø¯Ø§ÙƒÙ†Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„ØµÙ†Ø¯ÙˆÙ‚ */
      --glass-bg: rgba(255,255,255,0.13);        
      --glass-border: rgba(56,189,248,0.18);        
      --input-bg: rgba(30,41,59,0.9); /* Ù…Ø¯Ø®Ù„Ø§Øª Ø¯Ø§ÙƒÙ†Ø© */
      --input-focus: #38bdf8;        
      --input-border: #334155;        
      --error: #f87171;        
      --success: #22c55e;        
      --muted: #a5f3fc;        
      --radius: 28px;        
      --shadow: 0 8px 32px 0 rgba(2,6,23,0.4); /* Ø¸Ù„ Ø£ØºÙ…Ù‚ */
      --gold: #FFD369;        
      --gold-dark: #bfa243;        
    }        
    *{box-sizing:border-box}      
    html, body {        
      height: 100%;        
      margin: 0;        
      padding: 0;        
      font-family: "Cairo", "Montserrat", sans-serif;        
      color: #f1f6fb;        
      direction: rtl;        
      /* Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ø¯Ø§ÙƒÙ†Ø© ÙˆØ§Ù„Ø³Ù„Ø³Ø© */
      background: linear-gradient(rgba(0,0,0,0.8), rgba(0,0,0,0.9)), 
                  var(--main-gradient), 
                  url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1200&q=80');        
      background-size: cover;        
      background-attachment: fixed;        
      background-blend-mode: overlay;        
      overflow-y: auto !important;        
      scroll-behavior: smooth; /* Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø§Ù„Ø³Ù„Ø³ */
    }        
    body {        
      min-height: 100vh;        
      display: block;        
    }        
    .bg-glass {        
      position: fixed;        
      inset: 0;        
      z-index: 0;        
      pointer-events: none;        
      background: radial-gradient(circle at 65% 17%, rgba(56,189,248,0.05) 0%, transparent 90%), 
                  radial-gradient(circle at 25% 80%, rgba(34,197,94,0.06) 0%, transparent 80%);        
      filter: blur(28px) saturate(1.1);        
      animation: floatGlass 16s ease-in-out infinite alternate;        
    }        
    @keyframes floatGlass {        
      0% { background-position: 65% 17%, 25% 80%;}        
      100% { background-position: 55% 27%, 20% 95%;}        
    }        
    .center-box {        
      width: 100%;        
      max-width: 420px;        
      margin: 56px auto 56px auto;        
      padding: 38px 18px 30px 18px;        
      border-radius: var(--radius);        
      background: var(--dark-box-bg); /* Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ø¯Ø§ÙƒÙ†Ø© */
      box-shadow: var(--shadow), 0 0 10px #0008;        
      border: 2px solid var(--glass-border);        
      z-index: 2;        
      position: relative;        
      backdrop-filter: blur(0px) saturate(100%);         
      display: flex;        
      flex-direction: column;        
      align-items: center;        
    }        
    h2 {        
      margin-bottom: 20px;        
      font-family: "Montserrat", "Cairo", sans-serif;        
      font-size: 1.7rem;        
      font-weight: 900;        
      letter-spacing: 1.1px;        
      text-shadow: 0 0 10px #38bdf8a2;        
      color: #38bdf8;        
    }        
    .subtitle {        
      color: var(--muted);        
      font-size: 1rem;        
      margin-bottom: 19px;        
      font-weight: 700;        
      text-shadow: 0 0 4px #38bdf8a1;        
      letter-spacing: 0.5px;        
    }        
    .gold-name {        
      display: block;        
      background: var(--gold);        
      color: var(--gold-dark);        
      padding: 10px 17px 8px 17px;        
      min-width: 120px;        
      border-radius: 12px;        
      font-size: 1.08rem;        
      font-family: "Montserrat","Cairo",sans-serif;        
      font-weight: 900;        
      margin: 0 auto 18px auto;        
      text-align: center;        
      box-shadow: 0 4px 10px #FFD36944, 0 2px 8px #0002;        
      letter-spacing: 1.1px;        
      border: 2px solid #bfa24333;        
      user-select: none;        
    }        
    .form-view {       
      width: 100%;       
      opacity: 1;      
      transform: scale(1);      
    }        
    .form-view.fade-out {       
        opacity: 0;      
        transform: scale(0.95);      
        height: 0;       
        overflow: hidden;      
    }      
    .form-view.hidden-display {       
        display: none;      
    }  .form-row {        
  margin-bottom: 18px;        
  text-align: right;        
  position: relative;        
}      label {  
font-size: 1.08rem;  
color: var(--muted);  
margin-bottom: 6px;  
display: block;  
font-weight: 700;  
}  
input[type="text"], input[type="email"], input[type="password"], input[type="tel"] {  
width: 100%;  
padding: 16px 17px;  
border-radius: 15px;  
border: 2px solid var(--input-border);  
background: var(--input-bg);  
color: #fff;  
font-size: 1.11rem;  
font-family: "Cairo",sans-serif;  
transition: box-shadow .18s, border-color .18s, transform .12s;  
outline: none;  
font-weight: 600;  
margin-top: 2px;  
box-sizing: border-box;  
}  
input:focus {  
border-color: var(--input-focus);  
box-shadow: 0 0 12px #38bdf8a6;  
background: #1e293b;  
}  
.password-eye {  
position: absolute;  
left: 14px;  
top: 50%;  
transform: translateY(-50%);  
background: none;  
border: none;  
cursor: pointer;  
font-size: 1.35em;  
color: #38bdf8;  
opacity: 0.82;  
z-index: 3;  
transition: color .17s, opacity .14s;  
padding: 0;  
margin: 0;  
line-height: 1;  
outline: none;  
display: flex;  
align-items: center;  
height: 28px;  
width: 28px;  
justify-content: center;  
}  
.password-eye svg {  
width: 23px;  
height: 23px;  
display: block;  
}  
.password-eye:active,  
.password-eye:focus { opacity: 1; color: var(--gold); }  
.password-eye:hover { color: #FFD369; opacity: 1; }  
button {  
width: 100%;  
padding: 14px 0;  
border-radius: 15px;  
font-size: 1.07rem;  
font-weight: 900;  
font-family: "Montserrat","Cairo",sans-serif;  
letter-spacing: 0.7px;  
cursor: pointer;  
border: none;  
transition: .17s;  
margin-bottom: 14px;  
box-shadow: 0 3px 18px rgba(56,189,248,0.10);  
}  
.login-btn {  
background: linear-gradient(90deg,#FFD369 0%,#bfa243 100%);  
color: #2e2300;  
font-weight: 900;  
letter-spacing: 1.2px;  
border: 2px solid #bfa24366;  
}  
.login-btn:hover {  
background: linear-gradient(90deg,#bfa243 0%,#FFD369 100%);  
color: #fff;  
}  
.signup-btn {  
background: linear-gradient(90deg,#fb8500 0%,#ffb703 100%);  
color: #23272f;  
font-weight: 900;  
}  
.signup-btn:hover { background: linear-gradient(90deg,#ffb703,#fb8500); color: #fff; }  
.switcher, .forgot {  
background: none;  
border: none;  
color: var(--muted);  
font-size: 1rem;  
margin-bottom: 2px;  
text-decoration: underline;  
cursor: pointer;  
transition: color .13s;  
font-weight: 700;  
}  
.switcher:hover { color: #38bdf8; }  .message {
min-height: 36px;
padding: 12px 0 7px 0;
margin-bottom: 13px;
border-radius: 11px;
font-size: 1.05rem;
font-weight: bold;
box-shadow: 0 2px 12px #0002;
transition: .14s;
background: #fff;
color: #2e2300;
text-shadow: none;
border: 2px solid #FFD369;
opacity: 1;
display: block;
text-align: center;
position: relative;
}
.message .site-name {
display: block;
font-family: "Montserrat","Cairo",sans-serif;
font-size: 1.13em;
font-weight: 900;
color: var(--gold);
margin-bottom: 3px;
letter-spacing: 1.1px;
text-shadow: 0 0 7px #FFD36977;
}
.error {
background: #ffeaea !important;
color: #c00 !important;
border-color: #ff6b6b;
}
.success {
background: #e7ffea !important;
color: #049c3f !important;
border-color: #22c55e;
}
.footer {
margin-top: 16px;
font-size: .99rem;
color: #94a3b8;
opacity: 0.9;
font-weight: 500;
text-align: center;
}
@media (max-width: 600px) {
.center-box {
padding: 8px 1vw 8px 1vw;
border-radius: 14px;
max-width: 97vw;
}
h2 { font-size: 1.1rem; }
.subtitle { font-size: .93rem; }
.footer { font-size: .83rem; }
input, button { font-size: .93rem; }
.form-row { margin-bottom: 9px; }
.gold-name { font-size: .97rem; }
.message { font-size: .93rem; }
label { font-size: .91rem; }
}

  </style>        
</head>      
<body>      
  <div class="bg-glass" aria-hidden="true"></div>      
  <div class="center-box">      
    <h2 id="form-title">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Am Rewards</h2>      
    <div class="subtitle">Ø§Ù†Ø¶Ù… ÙˆØ§Ø¨Ø¯Ø£ Ø±Ø­Ù„ØªÙƒ Ù„Ù„Ø±Ø¨Ø­ Ø¨Ø³Ù‡ÙˆÙ„Ø© ÙˆØ£Ù…Ø§Ù†</div>      
    <span class="gold-name">Am Rewards</span>      
    <div id="msg" class="message" style="display:none;">      
      <span class="site-name">Am Rewards</span>      
      <span id="msg-text"></span>      
    </div>  
    <form id="login-form" class="form-view" autocomplete="on">      
      <div class="form-row">      
        <label for="login-email">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>      
        <input type="email" id="login-email" placeholder="example@mail.com" autocomplete="username" required />      
      </div>      
      <div class="form-row">      
        <label for="login-password">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>      
        <input type="password" id="login-password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" autocomplete="current-password" required />      
        <button type="button" class="password-eye" id="password-toggle-btn" tabindex="-1" aria-label="Ø¹Ø±Ø¶ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">      
          <svg class="eye-open" viewBox="0 0 24 24" fill="none"><path d="M1.5 12C3.5 7 8 3.5 12 3.5C16 3.5 20.5 7 22.5 12C20.5 17 16 20.5 12 20.5C8 20.5 3.5 17 1.5 12Z" stroke="currentColor" stroke-width="2"/><circle cx="12" cy="12" r="3.5" stroke="currentColor" stroke-width="2"/></svg>      
          <svg class="eye-closed" viewBox="0 0 24 24" fill="none" style="display:none;"><path d="M2.93 2.93L21.07 21.07M22.5 12C20.5 17 16 20.5 12 20.5C10.6364 20.5 9.3242 20.2443 8.08 19.75M1.5 12C3.5 7 8 3.5 12 3.5C13.3636 3.5 14.6758 3.7557 15.92 4.25M17.169 7.765C16.3263 7.0253 15.2289 6.5 14 6.5C11.5147 6.5 9.5 8.51472 9.5 11C9.5 12.1648 9.94054 13.238 10.669 14.075" stroke="currentColor" stroke-width="2"/></svg>      
        </button>      
      </div>      
      <button class="login-btn" id="login-btn" type="submit">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>      
    </form>    
    <a href="signup.html" class="switcher" type="button" style="text-decoration: none; display: block; text-align: center; width: 100%; margin-top: 0;">Ø£Ùˆ Ø£Ù†Ø´Ø¦ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</a>  
    <div class="footer">Â© 2025 Am Rewards â€¢ ÙƒÙ„ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</div>    
  </div>    
  <script type="module">      
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";      
    import {      
      getAuth,      
      setPersistence,      
      browserLocalPersistence,      
      signInWithEmailAndPassword      
    } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";      
    import {      
      getFirestore,      
      doc,      
      setDoc,      
      serverTimestamp,      
      updateDoc      
    } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";    
    
    // **1. Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase**
    const firebaseConfig = {      
      apiKey: "AIzaSyBfOJPkWbmcJ6s29bDNysr-H0Kx-Js3Gy0",      
      authDomain: "am--rewards.firebaseapp.com",      
      projectId: "am--rewards",      
    };      
    const app = initializeApp(firebaseConfig);      
    const auth = getAuth(app);      
    const db = getFirestore(app);      
    
    // 2. Ø¬Ù„Ø¨ Ø¹Ù†Ø§ØµØ± DOM
    const loginForm = document.getElementById("login-form"); 
    const msgEl = document.getElementById("msg");
    const msgTextEl = document.getElementById("msg-text");
    const loginEmail = document.getElementById("login-email");
    const loginPassword = document.getElementById("login-password");
    const loginBtn = document.getElementById("login-btn");
    const passwordToggleBtn = document.getElementById("password-toggle-btn"); // ğŸŒŸ Ø¬Ø¯ÙŠØ¯: Ø¬Ù„Ø¨ Ø²Ø± Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±

    // Ù…Ù†Ø·Ù‚ Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„Ø«Ø§Ø¨Øª (Admin)
    const ADMIN_EMAIL = "admin@am-rewards.com";
    const ADMIN_PASSWORD = "Admin@2025";
    const ADMIN_PAGE = "admin.html";
    
    // 3. Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©
    function showMessage(text, type="success") {
      msgTextEl.textContent = text;
      msgEl.className = "message " + type;
      msgEl.style.display = text ? "block" : "none";
      clearTimeout(window._msgTimeout);
      if (text) {
        window._msgTimeout = setTimeout(() => {
          if(type !== "error") msgEl.style.display = "none";
        }, type === "error" ? 10000 : 3000);
      }
    }

    function translateError(code) {
      switch(code) {
        case "auth/invalid-email": return "Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ§Ù„Ø­";
        case "auth/user-not-found":
        case "auth/wrong-password":
          return "Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©";
        case "auth/too-many-requests": return "ØªÙ… Ø­Ø¸Ø± Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø¤Ù‚ØªÙ‹Ø§ Ø¨Ø³Ø¨Ø¨ Ø¹Ø¯Ø© Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø®Ø§Ø·Ø¦Ø©ØŒ Ø§Ù†ØªØ¸Ø± Ù‚Ù„ÙŠÙ„Ù‹Ø§";
        default: return "Ø­Ø¯Ø« Ø®Ø·Ø£ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ø£Ùˆ ØªØ­Ù‚Ù‚ Ù…Ù† Ø¨ÙŠØ§Ù†Ø§ØªÙƒ.";
      }
    }

    async function updateLastLogin(uid) {
      try {
        const userRef = doc(db, "users", uid);
        await updateDoc(userRef, {
          lastLogin: serverTimestamp()
        });
        console.log(`lastLogin updated for user: ${uid}`);
      } catch (error) {
        console.error("Failed to update lastLogin, check Firestore rules:", error);
      }
    }


    // 4. Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    async function login(event) {
      event.preventDefault(); 
      
      const email = loginEmail.value.trim();
      const password = loginPassword.value.trim();

      if (!email || !password) return showMessage("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±", "error");

      loginBtn.textContent = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¯Ø®ÙˆÙ„...";
      loginBtn.disabled = true;

      // Ù…Ù†Ø·Ù‚ Ø§Ù„Ù…Ø´Ø±Ù (Admin)
      if (email === ADMIN_EMAIL && password === ADMIN_PASSWORD) {
        showMessage("âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø´Ø±Ù Ø¨Ù†Ø¬Ø§Ø­!", "success");
        sessionStorage.setItem('isAdmin', 'true');
        setTimeout(()=> window.location.href = ADMIN_PAGE, 1200);
        return;
      }

      try {
        await setPersistence(auth, browserLocalPersistence);
        const result = await signInWithEmailAndPassword(auth, email, password);
        const uid = result.user.uid;

        await updateLastLogin(uid);       
            
        const userRef = doc(db, "users", uid);      
        await setDoc(userRef, {      
            uid: uid,      
            email: email,      
        }, { merge: true });      
        
        showMessage("âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­!", "success");      
        setTimeout(()=> window.location.href = "dashboard.html", 1200);

      } catch (error) {
        loginBtn.textContent = "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„";
        loginBtn.disabled = false;
        showMessage(translateError(error.code), "error");
      }
    }
    
    // 5. Ø¯Ø§Ù„Ø© Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± (Ù…ÙØ­Ø³Ù‘Ù†Ø© Ù„Ù„Ø¹Ù…Ù„ Ø¯Ø§Ø®Ù„ÙŠÙ‹Ø§)
    function togglePassword() {
      const input = document.getElementById("login-password");
      const openIcon = passwordToggleBtn.querySelector('.eye-open');
      const closedIcon = passwordToggleBtn.querySelector('.eye-closed');

      if (input.type === "password") {
        input.type = "text";
        openIcon.style.display = "none";
        closedIcon.style.display = "block";
      } else {
        input.type = "password";
        openIcon.style.display = "block";
        closedIcon.style.display = "none";
      }
    }

    // ğŸŒŸ 6. Ø±Ø¨Ø· Ø§Ù„Ø¯ÙˆØ§Ù„ Ø¨Ù…Ø¯Ø®Ù„Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… addEventListener (Ø§Ù„Ø­Ù„ Ø§Ù„Ù…ÙˆØ«ÙˆÙ‚):
    loginForm.addEventListener("submit", login);
    passwordToggleBtn.addEventListener("click", togglePassword);
  </script>  
</body>
</html>
