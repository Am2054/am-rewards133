<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<title>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ - Am Rewards</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&family=Montserrat:wght@700&display=swap" rel="stylesheet">

<style>
:root {
  --bg1:#020617;
  --bg2:#0f172a;
  --card:#020617ee;
  --border:#38bdf833;
  --primary:#38bdf8;
  --gold:#FFD369;
  --danger:#ef4444;
  --success:#22c55e;
  --info:#0ea5e9;
  --radius:26px;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:"Cairo",sans-serif;
  min-height:100vh;
  background:
    radial-gradient(circle at 20% 20%, #38bdf81a, transparent 40%),
    radial-gradient(circle at 80% 80%, #FFD3691a, transparent 40%),
    linear-gradient(160deg,var(--bg1),var(--bg2));
  display:flex;
  align-items:center;
  justify-content:center;
  color:#f8fafc;
}

.center-box{
  width:100%;
  max-width:420px;
  padding:36px 28px;
  border-radius:var(--radius);
  background:var(--card);
  border:1.5px solid var(--border);
  box-shadow:0 20px 60px #0008;
  text-align:center;
}

h2{color:var(--primary);margin:0}
.gold-name{
  display:inline-block;
  margin:14px 0 26px;
  padding:10px 22px;
  border-radius:14px;
  background:var(--gold);
  color:#3b2f00;
  font-weight:900;
}

.form-row{text-align:right;margin-bottom:18px}
label{display:block;margin-bottom:6px;color:#a5f3fc;font-weight:700}

.input-group{position:relative}
input{
  width:100%;
  padding:15px 44px 15px 14px;
  border-radius:14px;
  border:1.5px solid #334155;
  background:#020617;
  color:#fff;
  font-size:1.05rem;
}
input:focus{outline:none;border-color:var(--primary)}

.password-toggle{
  position:absolute;
  left:12px;
  top:50%;
  transform:translateY(-50%);
  background:none;
  border:none;
  color:var(--primary);
  cursor:pointer;
  font-size:1.1rem;
}

.login-btn{
  width:100%;
  padding:14px;
  border-radius:16px;
  border:none;
  font-weight:900;
  font-size:1.1rem;
  background:linear-gradient(90deg,var(--gold),#eab308);
  color:#2e2300;
  cursor:pointer;
  transition:.2s;
}
.login-btn:disabled{opacity:.6;cursor:not-allowed}

.spinner{
  width:18px;height:18px;
  border:3px solid #ffffff55;
  border-top-color:#fff;
  border-radius:50%;
  display:inline-block;
  animation:spin .8s linear infinite;
}
@keyframes spin{to{transform:rotate(360deg)}}

.message{
  display:none;
  padding:12px;
  margin-bottom:16px;
  border-radius:12px;
  font-weight:700;
}
.message.error{background:#450a0a;color:#fecaca}
.message.success{background:#052e16;color:#bbf7d0}
.message.info{background:#082f49;color:#bae6fd}

.timer{
  margin-top:10px;
  font-weight:800;
  color:#fca5a5;
}
</style>
</head>

<body>

<div class="center-box">
  <h2>Am Rewards</h2>
  <span class="gold-name">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</span>

  <div id="msg" class="message"></div>
  <div id="timer" class="timer"></div>

  <div class="form-row">
    <label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
    <input id="email" type="email">
  </div>

  <div class="form-row">
    <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
    <div class="input-group">
      <input id="password" type="password">
      <button class="password-toggle" id="toggle">ğŸ‘</button>
    </div>
  </div>

  <button class="login-btn" id="btn">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, setPersistence, browserLocalPersistence } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

const firebaseConfig={
  apiKey:"AIzaSyBfOJPkWbmcJ6s29bDNysr-H0Kx-Js3Gy0",
  authDomain:"am--rewards.firebaseapp.com",
  projectId:"am--rewards"
};

initializeApp(firebaseConfig);
const auth=getAuth();

const btn=document.getElementById("btn");
const msg=document.getElementById("msg");
const timerEl=document.getElementById("timer");
const toggle=document.getElementById("toggle");
const pass=document.getElementById("password");

const MAX=5;
const LOCK=10*60*1000;

let attempts=+localStorage.getItem("attempts")||0;
let lockUntil=+localStorage.getItem("lockUntil")||0;

toggle.onclick=()=>{
  pass.type=pass.type==="password"?"text":"password";
  toggle.textContent=pass.type==="password"?"ğŸ‘":"ğŸ™ˆ";
};

function show(text,type){
  msg.textContent=text;
  msg.className="message "+type;
  msg.style.display="block";
}

function startTimer(){
  btn.disabled=true;
  const i=setInterval(()=>{
    const diff=lockUntil-Date.now();
    if(diff<=0){
      clearInterval(i);
      timerEl.textContent="";
      btn.disabled=false;
      attempts=0;
      localStorage.removeItem("attempts");
      localStorage.removeItem("lockUntil");
      show("ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰","info");
      return;
    }
    const m=Math.floor(diff/60000);
    const s=Math.floor((diff%60000)/1000);
    timerEl.textContent=`â³ Ø­Ø§ÙˆÙ„ Ø¨Ø¹Ø¯ ${m}:${s.toString().padStart(2,"0")}`;
  },1000);
}

if(Date.now()<lockUntil){
  show("ğŸš« ØªÙ… ØªØ¹Ø·ÙŠÙ„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù…Ø¤Ù‚ØªÙ‹Ø§","error");
  startTimer();
}else{
  show(`â„¹ï¸ Ù„Ø¯ÙŠÙƒ ${MAX} Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„`,"info");
}

btn.onclick=async()=>{
  btn.disabled=true;
  btn.innerHTML='<span class="spinner"></span>';

  try{
    await setPersistence(auth,browserLocalPersistence);
    await signInWithEmailAndPassword(
      auth,
      document.getElementById("email").value.trim(),
      pass.value
    );

    attempts=0;
    localStorage.clear();
    show("âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­","success");
    setTimeout(()=>location.href="dashboard.html",1000);

  }catch{
    attempts++;
    localStorage.setItem("attempts",attempts);

    if(attempts>=MAX){
      lockUntil=Date.now()+LOCK;
      localStorage.setItem("lockUntil",lockUntil);
      show("ğŸš« ØªÙ… ØªØ¹Ø·ÙŠÙ„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ 10 Ø¯Ù‚Ø§Ø¦Ù‚","error");
      startTimer();
    }else{
      show(`âš ï¸ Ù…Ø­Ø§ÙˆÙ„Ø© ${attempts} Ù…Ù† ${MAX}`,"error");
      btn.disabled=false;
      btn.textContent="ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„";
    }
  }
};
</script>

</body>
  </html>
